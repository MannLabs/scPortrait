<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>processing &mdash; scPortrait  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/fonts.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pipeline" href="pipeline.html" />
    <link rel="prev" title="Module Documentation" href="../module.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            scPortrait
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">scPortrait Ecosystem</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/computational_workflow.html">scPortrait workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quickstart/computational_workflow.html#segmentation">Segmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart/computational_workflow.html#extraction">Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart/computational_workflow.html#classification">Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart/computational_workflow.html#selection">Selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/example_scPortrait_project.html">A walk through the scPortrait Ecosystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Import-Required-Libraries">Import Required Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Generate-the-Project-Structure">Generate the Project Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Load-Imaging-Data">Load Imaging Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Method-1:-loading-images-from-file">Method 1: loading images from file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Method-2:-loading-images-from-numpy-array">Method 2: loading images from numpy array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Looking-at-the-loaded-images">Looking at the loaded images</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Generating-a-Segmentation">Generating a Segmentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Looking-at-Segmentation-Results">Looking at Segmentation Results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Extracting-single-cell-images">Extracting single-cell images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Look-at-extracted-single-cell-images">Look at extracted single-cell images</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Classification-of-extracted-single-cells">Classification of extracted single-cells</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#looking-at-the-generated-results">looking at the generated results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Exporting-Cutting-contours-for-excision-on-the-LMD7">Exporting Cutting contours for excision on the LMD7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pipeline.html">scPortrait Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/project.html">scPortrait Projects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/project.html#project-classes">Project classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/project.html#project">1. Project</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/project.html#timecourseproject">2. TimecourseProject</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/project.html#initializing-a-scportrait-project">Initializing a scPortrait Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/project.html#loading-images-into-a-scportrait-project">Loading Images into a scPortrait project</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/config.html">Config Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/segmentation.html">Segmentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/segmentation.html#segmentation-classes">Segmentation classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/segmentation.html#id2">1. Segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/segmentation.html#shardedsegmentation">2. ShardedSegmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/segmentation.html#timecoursesegmentation">3. TimecourseSegmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/segmentation.html#multithreadedsegmentation">4. MultithreadedSegmentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/segmentation.html#segmentation-workflows">Segmentation Workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/segmentation.html#wga-segmentation">WGA segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/segmentation.html#dapi-segmentation">DAPI segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/segmentation.html#cytosol-cellpose-segmentation">Cytosol Cellpose segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipeline/segmentation.html#dapi-cellpose-segmentation">DAPI Cellpose segmentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/extraction.html">Extraction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/extraction.html#extraction-classes">Extraction classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/extraction.html#single-cell-image-datasets">Single-cell image datasets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/classification.html">Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/selection.html">Selection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example_notebooks.html">Example Notebooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../example_notebooks.html#basic-scportrait-project">Basic scPortrait Project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_scPortrait_project.html">A walk through the scPortrait Ecosystem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Import-Required-Libraries">Import Required Libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Generate-the-Project-Structure">Generate the Project Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Load-Imaging-Data">Load Imaging Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Generating-a-Segmentation">Generating a Segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Extracting-single-cell-images">Extracting single-cell images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Classification-of-extracted-single-cells">Classification of extracted single-cells</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_scPortrait_project.html#Exporting-Cutting-contours-for-excision-on-the-LMD7">Exporting Cutting contours for excision on the LMD7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example_notebooks.html#timecourse-scportrait-project">Timecourse scPortrait Project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/Example_Notebook_TimeCourse_Project.html">Example Notebook Running scPortrait on datasets with multiple images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/Example_Notebook_TimeCourse_Project.html#Some-Helper-Functions-for-visualization-of-results">Some Helper Functions for visualization of results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/Example_Notebook_TimeCourse_Project.html#Initialize-a-Project">Initialize a Project</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/Example_Notebook_TimeCourse_Project.html#Input-Data-Format">Input Data Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/Example_Notebook_TimeCourse_Project.html#Example-Load-data-using-the-from-files-function">Example Load data using the from files function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/Example_Notebook_TimeCourse_Project.html#Segmentation">Segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/Example_Notebook_TimeCourse_Project.html#Single-Cell-Extraction">Single-Cell Extraction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example_notebooks.html#segmentation-workflows">Segmentation Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../notebooks/example_notebook_segmentation_workflows.html">Example Notebook showcasing the different segmentation workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_notebook_segmentation_workflows.html#WGA-Segmentation">WGA Segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_notebook_segmentation_workflows.html#DAPI-Segmentation">DAPI Segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_notebook_segmentation_workflows.html#Cytosol-Segmentation-Cellpose">Cytosol Segmentation Cellpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../notebooks/example_notebook_segmentation_workflows.html#DAPI-Segmentation-Cellpose">DAPI Segmentation Cellpose</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sparcscmd.html">Command Line Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sparcscmd/sparcs_split.html">sparcs-split</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_split.html#positional-arguments">Positional Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_split.html#named-arguments">Named Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_split.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sparcscmd/sparcs_stat.html">sparcs-stat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_stat.html#positional-arguments">Positional Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_stat.html#named-arguments">Named Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_stat.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sparcscmd/sparcs_cleanup.html">sparcs-cleanup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_cleanup.html#positional-arguments">Positional Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_cleanup.html#named-arguments">Named Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sparcscmd/sparcs_cleanup.html#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../module.html">Module Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-scportrait.processing.utils">utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.utils.plot_image"><code class="docutils literal notranslate"><span class="pre">plot_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.utils.visualize_class"><code class="docutils literal notranslate"><span class="pre">visualize_class()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.utils.download_testimage"><code class="docutils literal notranslate"><span class="pre">download_testimage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.utils.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-scportrait.processing.preprocessing">preprocessing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.preprocessing.percentile_normalization"><code class="docutils literal notranslate"><span class="pre">percentile_normalization()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.preprocessing.downsample_img"><code class="docutils literal notranslate"><span class="pre">downsample_img()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.preprocessing.downsample_img_pxs"><code class="docutils literal notranslate"><span class="pre">downsample_img_pxs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.preprocessing.rolling_window_mean"><code class="docutils literal notranslate"><span class="pre">rolling_window_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.preprocessing.origins_from_distance"><code class="docutils literal notranslate"><span class="pre">origins_from_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.preprocessing.MinMax"><code class="docutils literal notranslate"><span class="pre">MinMax()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.preprocessing.EDF"><code class="docutils literal notranslate"><span class="pre">EDF()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.preprocessing.maximum_intensity_projection"><code class="docutils literal notranslate"><span class="pre">maximum_intensity_projection()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-scportrait.processing.segmentation">segmentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.global_otsu"><code class="docutils literal notranslate"><span class="pre">global_otsu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.segment_global_threshold"><code class="docutils literal notranslate"><span class="pre">segment_global_threshold()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.segment_local_threshold"><code class="docutils literal notranslate"><span class="pre">segment_local_threshold()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.remove_edge_labels"><code class="docutils literal notranslate"><span class="pre">remove_edge_labels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.shift_labels"><code class="docutils literal notranslate"><span class="pre">shift_labels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.remove_classes"><code class="docutils literal notranslate"><span class="pre">remove_classes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.contact_filter_lambda"><code class="docutils literal notranslate"><span class="pre">contact_filter_lambda()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.contact_filter"><code class="docutils literal notranslate"><span class="pre">contact_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.size_filter"><code class="docutils literal notranslate"><span class="pre">size_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.numba_mask_centroid"><code class="docutils literal notranslate"><span class="pre">numba_mask_centroid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.sc_any"><code class="docutils literal notranslate"><span class="pre">sc_any()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.segmentation.sc_all"><code class="docutils literal notranslate"><span class="pre">sc_all()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-scportrait.processing.filtering">filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.filtering.BaseFilter"><code class="docutils literal notranslate"><span class="pre">BaseFilter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.filtering.SizeFilter"><code class="docutils literal notranslate"><span class="pre">SizeFilter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scportrait.processing.filtering.MatchNucleusCytosolIds"><code class="docutils literal notranslate"><span class="pre">MatchNucleusCytosolIds</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pipeline.html">pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pipeline.html#base">base</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#logable">Logable</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#processingstep">ProcessingStep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.html#project">project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#id1">Project</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#timecourseproject">TimecourseProject</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.html#segmentation">segmentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#id4">Segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#shardedsegmentation">ShardedSegmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#timecoursesegmentation">TimecourseSegmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#multithreadedtimecoursesegmentation">MultithreadedTimecourseSegmentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.html#module-scportrait.pipeline.workflows">workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.WGASegmentation"><code class="docutils literal notranslate"><span class="pre">WGASegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.ShardedWGASegmentation"><code class="docutils literal notranslate"><span class="pre">ShardedWGASegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.DAPISegmentation"><code class="docutils literal notranslate"><span class="pre">DAPISegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.ShardedDAPISegmentation"><code class="docutils literal notranslate"><span class="pre">ShardedDAPISegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.DAPISegmentationCellpose"><code class="docutils literal notranslate"><span class="pre">DAPISegmentationCellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.ShardedDAPISegmentationCellpose"><code class="docutils literal notranslate"><span class="pre">ShardedDAPISegmentationCellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.CytosolSegmentationCellpose"><code class="docutils literal notranslate"><span class="pre">CytosolSegmentationCellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.ShardedCytosolSegmentationCellpose"><code class="docutils literal notranslate"><span class="pre">ShardedCytosolSegmentationCellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.CytosolSegmentationDownsamplingCellpose"><code class="docutils literal notranslate"><span class="pre">CytosolSegmentationDownsamplingCellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.ShardedCytosolSegmentationDownsamplingCellpose"><code class="docutils literal notranslate"><span class="pre">ShardedCytosolSegmentationDownsamplingCellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.CytosolOnlySegmentationCellpose"><code class="docutils literal notranslate"><span class="pre">CytosolOnlySegmentationCellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.Sharded_CytosolOnly_Cellpose_Segmentation"><code class="docutils literal notranslate"><span class="pre">Sharded_CytosolOnly_Cellpose_Segmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.CytosolOnly_Segmentation_Downsampling_Cellpose"><code class="docutils literal notranslate"><span class="pre">CytosolOnly_Segmentation_Downsampling_Cellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.Sharded_CytosolOnly_Segmentation_Downsampling_Cellpose"><code class="docutils literal notranslate"><span class="pre">Sharded_CytosolOnly_Segmentation_Downsampling_Cellpose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.WGA_TimecourseSegmentation"><code class="docutils literal notranslate"><span class="pre">WGA_TimecourseSegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.Multithreaded_WGA_TimecourseSegmentation"><code class="docutils literal notranslate"><span class="pre">Multithreaded_WGA_TimecourseSegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.Cytosol_Cellpose_TimecourseSegmentation"><code class="docutils literal notranslate"><span class="pre">Cytosol_Cellpose_TimecourseSegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.Cytosol_Cellpose_Downsampling_TimecourseSegmentation"><code class="docutils literal notranslate"><span class="pre">Cytosol_Cellpose_Downsampling_TimecourseSegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.CytosolOnly_Cellpose_TimecourseSegmentation"><code class="docutils literal notranslate"><span class="pre">CytosolOnly_Cellpose_TimecourseSegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.Multithreaded_Cytosol_Cellpose_TimecourseSegmentation"><code class="docutils literal notranslate"><span class="pre">Multithreaded_Cytosol_Cellpose_TimecourseSegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.Multithreaded_Cytosol_Cellpose_Downsampling_TimecourseSegmentation"><code class="docutils literal notranslate"><span class="pre">Multithreaded_Cytosol_Cellpose_Downsampling_TimecourseSegmentation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#scportrait.pipeline.workflows.Multithreaded_CytosolOnly_Cellpose_TimecourseSegmentation"><code class="docutils literal notranslate"><span class="pre">Multithreaded_CytosolOnly_Cellpose_TimecourseSegmentation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.html#extraction">extraction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#hdf5cellextraction">HDF5CellExtraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#timecoursehdf5cellextraction">TimecourseHDF5CellExtraction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.html#classification">classification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#mlclusterclassifier">MLClusterClassifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#cellfeaturizer">CellFeaturizer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.html#selection">selection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pipeline.html#lmdselection">LMDSelection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ml.html">ml</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ml.html#module-scportrait.ml.datasets">datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.datasets.HDF5SingleCellDataset"><code class="docutils literal notranslate"><span class="pre">HDF5SingleCellDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.datasets.HDF5SingleCellDatasetRegression"><code class="docutils literal notranslate"><span class="pre">HDF5SingleCellDatasetRegression</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.datasets.HDF5SingleCellDatasetRegressionSubset"><code class="docutils literal notranslate"><span class="pre">HDF5SingleCellDatasetRegressionSubset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ml.html#module-scportrait.ml.metrics">metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.metrics.precision"><code class="docutils literal notranslate"><span class="pre">precision()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.metrics.recall"><code class="docutils literal notranslate"><span class="pre">recall()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ml.html#models">models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.models.VGGBase"><code class="docutils literal notranslate"><span class="pre">VGGBase</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.models.VGG1"><code class="docutils literal notranslate"><span class="pre">VGG1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.models.VGG2"><code class="docutils literal notranslate"><span class="pre">VGG2</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ml.html#plmodels">plmodels</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.plmodels.MultilabelSupervisedModel"><code class="docutils literal notranslate"><span class="pre">MultilabelSupervisedModel</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ml.html#module-scportrait.ml.pretrained_models">pretrained_models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.pretrained_models.autophagy_classifier1_0"><code class="docutils literal notranslate"><span class="pre">autophagy_classifier1_0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.pretrained_models.autophagy_classifier2_0"><code class="docutils literal notranslate"><span class="pre">autophagy_classifier2_0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.pretrained_models.autophagy_classifier2_1"><code class="docutils literal notranslate"><span class="pre">autophagy_classifier2_1()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ml.html#module-scportrait.ml.transforms">transforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.transforms.RandomRotation"><code class="docutils literal notranslate"><span class="pre">RandomRotation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.transforms.GaussianNoise"><code class="docutils literal notranslate"><span class="pre">GaussianNoise</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.transforms.GaussianBlur"><code class="docutils literal notranslate"><span class="pre">GaussianBlur</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.transforms.ChannelReducer"><code class="docutils literal notranslate"><span class="pre">ChannelReducer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.transforms.ChannelSelector"><code class="docutils literal notranslate"><span class="pre">ChannelSelector</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ml.html#module-scportrait.ml.utils">utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.utils.combine_datasets_balanced"><code class="docutils literal notranslate"><span class="pre">combine_datasets_balanced()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ml.html#scportrait.ml.utils.split_dataset_fractions"><code class="docutils literal notranslate"><span class="pre">split_dataset_fractions()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#module-scportrait.utils.vis">vis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="utils.html#scportrait.utils.vis.plot_segmentation_mask"><code class="docutils literal notranslate"><span class="pre">plot_segmentation_mask()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">scPortrait</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../module.html">Module Documentation</a></li>
      <li class="breadcrumb-item active">processing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/pages/module/processing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="processing">
<h1>processing<a class="headerlink" href="#processing" title="Link to this heading"></a></h1>
<section id="module-scportrait.processing.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-scportrait.processing.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.utils.plot_image">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.utils.</span></span><span class="sig-name descname"><span class="pre">plot_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'magma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.utils.plot_image" title="Link to this definition"></a></dt>
<dd><p>Visualize and optionally save an input array as an image.</p>
<p>This function displays a 2D array using matplotlib and can save
the resulting image as a PNG file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>np.array</em>) – Input 2D numpy array to be plotted.</p></li>
<li><p><strong>size</strong> (<em>tuple</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – Figure size in inches, by default (10, 10).</p></li>
<li><p><strong>save_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the output file, without extension. If not provided, image will not be saved, by default “”.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Color map used to display the array, by default “magma”.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to <cite>ax.imshow</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function will display the image but does not return any values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; array = np.random.rand(10, 10)
&gt;&gt;&gt; plot_image(array, size=(5, 5))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.utils.visualize_class">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.utils.</span></span><span class="sig-name descname"><span class="pre">visualize_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.utils.visualize_class" title="Link to this definition"></a></dt>
<dd><p>Visualize specific classes in a segmentation map by highlighting them on top of a background image.</p>
<p>This function takes in class IDs and a segmentation map, and creates an output visualization
where the specified classes are highlighted on top of the provided background image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_ids</strong> (<em>array-like</em>) – A list or array of integers representing the class IDs to be highlighted.</p></li>
<li><p><strong>seg_map</strong> (<em>2D array-like</em>) – A 2D array representing the segmentation map, where each value corresponds to a class ID.</p></li>
<li><p><strong>image</strong> (<em>2D/3D array-like</em>) – Background image (2D or 3D) on which the classes will be highlighted. Its size should match that of <cite>seg_map</cite>.</p></li>
<li><p><strong>*args</strong> – Any additional positional arguments that are passed to the underlying plotting functions.</p></li>
<li><p><strong>**kwargs</strong> – Any additional keyword arguments that are passed underlying plotting functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function will display the highlighted image but does not return any values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; class_ids = [1, 2]
&gt;&gt;&gt; seg_map = np.array([[0, 1, 0], [1, 2, 1], [2, 0, 1]])
&gt;&gt;&gt; background = np.random.random((3, 3)) * 255
&gt;&gt;&gt; visualize_class(class_ids, seg_map, background)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.utils.download_testimage">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.utils.</span></span><span class="sig-name descname"><span class="pre">download_testimage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.utils.download_testimage" title="Link to this definition"></a></dt>
<dd><p>Download a set of test images to a provided folder path.</p>
<p>This function downloads a set of test images from Zenodo and saves them to a provided folder path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>folder</strong> (<em>str</em>) – The path of the folder where the test images will be saved.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing the local file paths of the downloaded images.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>returns (list)</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; folder = “test_images”
&gt;&gt;&gt; downloaded_images = download_testimage(folder)
Successfully downloaded testimage_dapi.tiff from <a class="reference external" href="https://zenodo.org/record/5701474/files/testimage_dapi.tiff?download=1">https://zenodo.org/record/5701474/files/testimage_dapi.tiff?download=1</a>
Successfully downloaded testimage_wga.tiff from <a class="reference external" href="https://zenodo.org/record/5701474/files/testimage_wga.tiff?download=1">https://zenodo.org/record/5701474/files/testimage_wga.tiff?download=1</a>
&gt;&gt;&gt; print(downloaded_images)
[‘test_images/testimage_dapi.tiff’, ‘test_images/testimage_wga.tiff’]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.utils.flatten">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.utils.</span></span><span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.utils.flatten" title="Link to this definition"></a></dt>
<dd><p>Flatten a list of lists into a single list.</p>
<p>This function takes in a list of lists (nested lists) and returns a single list
containing all the elements from the input lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list</strong> (<em>list</em><em> of </em><em>lists</em>) – A list containing one or more lists as its elements.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A single list containing all elements from the input lists.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>flattened_list (list)</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; nested_list = [[1, 2, 3], [4, 5], [6, 7, 8, 9]]
&gt;&gt;&gt; flatten(nested_list)
[1, 2, 3, 4, 5, 6, 7, 8, 9]</p>
</dd></dl>

</section>
<section id="module-scportrait.processing.preprocessing">
<span id="preprocessing"></span><h2>preprocessing<a class="headerlink" href="#module-scportrait.processing.preprocessing" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.preprocessing.percentile_normalization">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.preprocessing.</span></span><span class="sig-name descname"><span class="pre">percentile_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.preprocessing.percentile_normalization" title="Link to this definition"></a></dt>
<dd><p>Normalize an input image channel-wise based on defined percentiles.</p>
<p>The percentiles will be calculated, and the image will be normalized to [0, 1]
based on the lower and upper percentile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>np.array</em>) – Numpy array of shape (height, width) or (channels, height, width).</p></li>
<li><p><strong>lower_percentile</strong> (<em>float</em><em>, </em><em>optional</em>) – Lower percentile used for normalization, all lower values will be clipped to 0. Defaults to 0.001.</p></li>
<li><p><strong>upper_percentile</strong> (<em>float</em><em>, </em><em>optional</em>) – Upper percentile used for normalization, all higher values will be clipped to 1. Defaults to 0.999.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized Numpy array with dtype == float</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>im (np.array)</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; img = np.random.rand(3, 4, 4) # (channels, height, width)
&gt;&gt;&gt; norm_img = percentile_normalization(img, 0.001, 0.999)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.preprocessing.downsample_img">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.preprocessing.</span></span><span class="sig-name descname"><span class="pre">downsample_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dtype=&lt;class</span> <span class="pre">'numpy.uint16'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.preprocessing.downsample_img" title="Link to this definition"></a></dt>
<dd><p>Function to downsample an image in shape CXY equivalent to NxN binning using the mean between pixels.
Takes a numpy array image as input and returns a numpy array as uint16.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>array</em>) – image to downsample</p></li>
<li><p><strong>N</strong> (<em>int</em><em>, </em><em>default = 2</em>) – number of pixels that should be binned together using mean between pixels</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.preprocessing.downsample_img_pxs">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.preprocessing.</span></span><span class="sig-name descname"><span class="pre">downsample_img_pxs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.preprocessing.downsample_img_pxs" title="Link to this definition"></a></dt>
<dd><p>Function to downsample an image in shape CXY equivalent to taking every N’th pixel from each dimension.
Channels are preserved as is. This does not use any interpolation and is therefore faster than the mean
method but is less precise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>array</em>) – image to downsample</p></li>
<li><p><strong>N</strong> (<em>int</em><em>, </em><em>default = 2</em>) – the nth pixel to take from each dimension</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.preprocessing.rolling_window_mean">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.preprocessing.</span></span><span class="sig-name descname"><span class="pre">rolling_window_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.preprocessing.rolling_window_mean" title="Link to this definition"></a></dt>
<dd><p>Compute rolling window mean and normalize the input 2D array.</p>
<p>The function takes an input 2D array and a window size. It calculates the mean
within a rolling window of provided size and removes the mean from each element
in the window. The modified array is returned. If scaling is set to True,
the chunk is normalized by dividing by its standard deviation.
Function is numba optimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>np.array</em>) – Input 2D numpy array.</p></li>
<li><p><strong>size</strong> (<em>int</em>) – Size of the rolling window.</p></li>
<li><p><strong>scaling</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, normalizes the chunk by dividing it by standard deviation, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed 2D numpy array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array (np.array)</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; array = np.random.rand(10, 10)
&gt;&gt;&gt; rolling_array = rolling_window_mean(array, size=5, scaling=False)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.preprocessing.origins_from_distance">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.preprocessing.</span></span><span class="sig-name descname"><span class="pre">origins_from_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.preprocessing.origins_from_distance" title="Link to this definition"></a></dt>
<dd><p>Compute a list of local peaks (origins) in the input array.
The function applies a Gaussian filter to the input array, creates a binary
mask using a threshold based on the standard deviation of the filtered data, and
performs a distance transform on the mask. It finds the local peaks of the
distance-transformed image with a minimum distance between the peaks,
and returns the coordinates and a map of the peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>np.array</em>) – Input 2D numpy array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of peak coordinates, shape (num_peaks, 2).
peak_map (np.array): Binary map of peaks, same shape as input array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>peak_list (np.array)</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; array = np.random.rand(10, 10)
&gt;&gt;&gt; peak_list, peak_map = origins_from_distance(array)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.preprocessing.MinMax">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.preprocessing.</span></span><span class="sig-name descname"><span class="pre">MinMax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inarr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.preprocessing.MinMax" title="Link to this definition"></a></dt>
<dd><p>Perform Min-Max normalization on the input array.
The function scales the input array values to the range [0, 1] using Min-Max
normalization. If the range of the input array (i.e., max - min) is zero,
the original array is returned unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inarr</strong> (<em>np.array</em>) – Input 2D numpy array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Min-Max normalized numpy array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; array = np.random.rand(10, 10)
&gt;&gt;&gt; normalized_array = MinMax(array)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.preprocessing.EDF">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.preprocessing.</span></span><span class="sig-name descname"><span class="pre">EDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.preprocessing.EDF" title="Link to this definition"></a></dt>
<dd><p>Calculate Extended Depth of Field for the given input image Z-stack.
Based on implementation here: <a class="reference external" href="https://mahotas.readthedocs.io/en/latest/edf.html#id3">https://mahotas.readthedocs.io/en/latest/edf.html#id3</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image</strong> (<em>np.array</em>) – Input image array of shape (Z, X, Y)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>EDF selected image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.preprocessing.maximum_intensity_projection">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.preprocessing.</span></span><span class="sig-name descname"><span class="pre">maximum_intensity_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.preprocessing.maximum_intensity_projection" title="Link to this definition"></a></dt>
<dd><p>Calculate Extended Depth of Field for the given input image Zstack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image</strong> (<em>np.array</em>) – Input image array of shape (Z, X, Y)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Maximum Intensity Projected Image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-scportrait.processing.segmentation">
<span id="segmentation"></span><h2>segmentation<a class="headerlink" href="#module-scportrait.processing.segmentation" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.global_otsu">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">global_otsu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.global_otsu" title="Link to this definition"></a></dt>
<dd><p>Calculate the optimal global threshold for an input grayscale image using Otsu’s method.</p>
<p>Otsu’s method maximizes the between-class variance and minimizes the within-class variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image</strong> (<em>np.array</em>) – Input grayscale image.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>threshold</strong> – Optimal threshold value calculated using Otsu’s method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">coins</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshold</span> <span class="o">=</span> <span class="n">global_otsu</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.segment_global_threshold">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">segment_global_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_footprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speckle_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.segment_global_threshold" title="Link to this definition"></a></dt>
<dd><p>Segments an image based on a global threshold determined using Otsu’s method, followed by peak detection using
distance transforms and watershed segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.array</em>) – Input grayscale image.</p></li>
<li><p><strong>dilation</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the structuring element for the dilation operation (default is 4).</p></li>
<li><p><strong>min_distance</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of pixels separating peaks (default is 10).</p></li>
<li><p><strong>peak_footprint</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the structuring element used for finding local maxima (default is 7).</p></li>
<li><p><strong>speckle_kernel</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the structuring element used for speckle removal (default is 4).</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, intermediate results are plotted (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>labels</strong> – Labeled array, where each unique feature in the input image has a unique label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">segment</span> <span class="kn">import</span> <span class="n">segment_global_threshold</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coins</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">coins</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">segment_global_threshold</span><span class="p">(</span><span class="n">coins</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">min_distance</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">peak_footprint</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">speckle_kernel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.segment_local_threshold">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">segment_local_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">51</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_footprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speckle_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.segment_local_threshold" title="Link to this definition"></a></dt>
<dd><p>This function takes a unprocessed image with low background noise and extracts and segments approximately round foreground objects
based on intensity. The image is segmented using the local (adaptive) threshold method. It first applies a local threshold based on
the median value of a block of pixels, followed by peak detection using distance transforms and watershed segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.array</em>) – Input grayscale image.</p></li>
<li><p><strong>dilation</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the structuring element for the dilation operation (default is 4).</p></li>
<li><p><strong>thr</strong> (<em>float</em><em>, </em><em>optional</em>) – The value added to the median of the block of pixels when calculating the local threshold (default is 0.01).</p></li>
<li><p><strong>median_block</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the block of pixels used to compute the local threshold (default is 51).</p></li>
<li><p><strong>min_distance</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of pixels separating peaks (default is 10).</p></li>
<li><p><strong>peak_footprint</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the structuring element used for finding local maxima (default is 7).</p></li>
<li><p><strong>speckle_kernel</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the structuring element used for speckle removal (default is 4).</p></li>
<li><p><strong>median_step</strong> (<em>int</em><em>, </em><em>optional</em>) – The step size for downsampling the image before applying the local threshold (default is 1).</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, intermediate results are plotted (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>labels</strong> – Labeled array, where each unique feature in the input image has a unique label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">coins</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">segment_local_threshold</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">thr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">median_block</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span> <span class="n">min_distance</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">peak_footprint</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">speckle_kernel</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.remove_edge_labels">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">remove_edge_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.remove_edge_labels" title="Link to this definition"></a></dt>
<dd><p>Remove the labels in contact with the edges of the input_map.
:param input_map: Input segmentation as a 2D or 3D numpy array of integers.
:type input_map: np.ndarray</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.shift_labels">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">shift_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_shifted_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_edge_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.shift_labels" title="Link to this definition"></a></dt>
<dd><p>Shift the labels of a given labeled map (2D or 3D numpy array) by a specific value.
Return the shifted map and the labels that are in contact with the edges of the canvas.
All labels but the background are incremented and all classes in contact with the edges of the
canvas are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_map</strong> (<em>np.ndarray</em>) – Input segmentation as a 2D or 3D numpy array of integers.</p></li>
<li><p><strong>shift</strong> (<em>int</em>) – Value to increment the labels by.</p></li>
<li><p><strong>return_shifted_labels</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return the edge labels after shifting (default is False).
If False will return the edge labels before shifting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>shifted_map</strong> (<em>np.ndarray</em>) – The labeled map with incremented labels.</p></li>
<li><p><strong>edge_labels</strong> (<em>list</em>) – List of unique labels in contact with the edges of the canvas.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shift</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_map</span><span class="p">,</span> <span class="n">edge_labels</span> <span class="o">=</span> <span class="n">shift_labels</span><span class="p">(</span><span class="n">input_map</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">shifted_map</span><span class="p">)</span>
<span class="go">array([[11,  0,  0],</span>
<span class="go">    [ 0, 12,  0],</span>
<span class="go">    [ 0,  0, 13]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">edge_labels</span><span class="p">)</span>
<span class="go">[11, 13]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.remove_classes">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">remove_classes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_remove</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.remove_classes" title="Link to this definition"></a></dt>
<dd><p>Wrapper function for the numba optimized _remove_classes function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_in</strong> (<em>np.ndarray</em>) – Input labeled array.</p></li>
<li><p><strong>to_remove</strong> (<em>list</em>) – List of label classes to remove.</p></li>
<li><p><strong>background</strong> (<em>int</em><em>, </em><em>optional</em>) – Value used to represent the background class (default is 0).</p></li>
<li><p><strong>reindex</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, reindex the remaining classes after removal (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>label</strong> – Labeled array with specified classes removed or reindexed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remove_classes</span><span class="p">(</span><span class="n">label_in</span><span class="p">,</span> <span class="n">to_remove</span><span class="p">)</span>
<span class="go">array([[0, 2, 0],</span>
<span class="go">       [0, 0, 2],</span>
<span class="go">       [0, 2, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.contact_filter_lambda">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">contact_filter_lambda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.contact_filter_lambda" title="Link to this definition"></a></dt>
<dd><p>Calculate the contact proportion of classes in the labeled array.</p>
<p>This function calculates the surrounding background and non-background elements
for each class in the label array and returns the proportion of background elements
to total surrounding elements for each class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>np.ndarray</em>) – Input labeled array.</p></li>
<li><p><strong>background</strong> (<em>int</em><em>, </em><em>optional</em>) – Value used to represent the background class (default is 0).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pop</strong> – Array containing the contact proportion for each class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contact_filter_lambda</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="go">array([1.        , 1.,  0.6 ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.contact_filter">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">contact_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.contact_filter" title="Link to this definition"></a></dt>
<dd><p>Filter the input labeled array based on its contact with background pixels.</p>
<p>This function filters an input labeled array by removing classes with a background
contact proportion less than the given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inarr</strong> (<em>np.ndarray</em>) – Input labeled array.</p></li>
<li><p><strong>threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – Specifies the minimum background contact proportion for class retention (default is 1).</p></li>
<li><p><strong>reindex</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, reindexes the remaining classes after removal (default is False).</p></li>
<li><p><strong>background</strong> (<em>int</em><em>, </em><em>optional</em>) – Value used to represent the background class (default is 0).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>label</strong> – Filtered labeled array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contact_filter</span><span class="p">(</span><span class="n">inarr</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">array([[0, 1, 1],</span>
<span class="go">       [0, 0, 1],</span>
<span class="go">       [0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.size_filter">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">size_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">100000]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.size_filter" title="Link to this definition"></a></dt>
<dd><p>Filter classes in a labeled array based on their size (number of pixels).</p>
<p>This function filters classes in the input labeled array by removing classes
that have a size (number of pixels) outside the provided limits. Optionally,
it can reindex the remaining classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>np.ndarray</em>) – Input labeled array.</p></li>
<li><p><strong>limits</strong> (<em>list</em><em>, </em><em>optional</em>) – List containing the minimum and maximum allowed class size (number of pixels)
(default is [0, 100000]).</p></li>
<li><p><strong>background</strong> (<em>int</em><em>, </em><em>optional</em>) – Value used to represent the background class (default is 0).</p></li>
<li><p><strong>reindex</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, reindexes the remaining classes after removal (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>label</strong> – Filtered labeled array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_filter</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">array([[0, 0, 0],</span>
<span class="go">       [0, 2, 0],</span>
<span class="go">       [0, 0, 2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.numba_mask_centroid">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">numba_mask_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.numba_mask_centroid" title="Link to this definition"></a></dt>
<dd><p>Calculate the centroids of classes in a given mask.</p>
<p>This function calculates the centroids of each class in the mask and returns an array
with the (y, x) coordinates of the centroids, the number of pixels associated with
each class, and the id number of each class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<em>numpy.ndarray</em>) – Input mask containing classes.</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – Debug flag (default is False).</p></li>
<li><p><strong>skip_background</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, skip background class (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>center</strong> (<em>numpy.ndarray</em>) – Array containing the (y, x) coordinates of the centroids of each class.</p></li>
<li><p><strong>points_class</strong> (<em>numpy.ndarray</em>) – Array containing the number of pixels associated with each class.</p></li>
<li><p><strong>ids</strong> (<em>numpy.ndarray</em>) – Array containing the id number of each class.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numba_mask_centroid</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="go">(array([[0.33333333, 1.66666667],</span>
<span class="go">        [1.5       , 1.5       ]]),</span>
<span class="go">array([3, 2], dtype=uint32),</span>
<span class="go">array([1, 2], dtype=uint32))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.sc_any">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">sc_any</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.sc_any" title="Link to this definition"></a></dt>
<dd><p>Short-circuiting replacement for np.any()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>np.ndarray</em>) – Input array to check if any values are True</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean value indicating if expression evaluated to True or False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scportrait.processing.segmentation.sc_all">
<span class="sig-prename descclassname"><span class="pre">scportrait.processing.segmentation.</span></span><span class="sig-name descname"><span class="pre">sc_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.segmentation.sc_all" title="Link to this definition"></a></dt>
<dd><p>Short-circuiting replacement for np.all()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>np.ndarray</em>) – Input array to check if all values are True</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean value indicating if expression evaluated to True or False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-scportrait.processing.filtering">
<span id="filtering"></span><h2>filtering<a class="headerlink" href="#module-scportrait.processing.filtering" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="scportrait.processing.filtering.BaseFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scportrait.processing.filtering.</span></span><span class="sig-name descname"><span class="pre">BaseFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.BaseFilter" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.BaseFilter.get_updated_mask">
<span class="sig-name descname"><span class="pre">get_updated_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids_to_remove</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.BaseFilter.get_updated_mask" title="Link to this definition"></a></dt>
<dd><p>Update the given mask by setting the values corresponding to the specified IDs to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<em>numpy.ndarray</em>) – The mask to be updated.</p></li>
<li><p><strong>ids_to_remove</strong> (<em>numpy.ndarray</em>) – The IDs to be removed from the mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated mask with the specified IDs set to 0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scportrait.processing.filtering.SizeFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scportrait.processing.filtering.</span></span><span class="sig-name descname"><span class="pre">SizeFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'segmask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_qc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">population_to_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'largest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erosion_dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.SizeFilter" title="Link to this definition"></a></dt>
<dd><p>Filter class for removing objects from a mask based on their size.</p>
<p>This class provides methods to remove objects from a segmentation mask based on their size.
If specified the objects are filtered using a threshold range passed by the user. Otherwise,
this threshold range will be automatically calculated.</p>
<p>To automatically calculate the threshold range, a gaussian mixture model will be fitted to the data.
Per default, the number of components is set to 2, as it is assumed that the objects in the mask can be divided into two
groups: small and large objects. The small objects constitute segmentation artefacts (partial masks that are
frequently generated by segmentation models like e.g. cellpose) while the large objects
represent the actual cell masks of interest. Using the fitted model, the filtering thresholds are calculated
to remove all cells that fall outside of the given confidence interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter_threshold</strong> (<em>tuple</em><em> of </em><em>floats</em><em>, </em><em>optional</em>) – The lower and upper thresholds for object size filtering. If not provided, it will be automatically calculated.</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>optional</em>) – The label of the mask. Default is “segmask”.</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to take the logarithm of the size of the objects before fitting the normal distribution. Default is True.
By enabling this option, the filter will better be able to distinguish between small and large objects.</p></li>
<li><p><strong>plot_qc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot quality control figures. Default is True.</p></li>
<li><p><strong>directory</strong> (<em>str</em><em>, </em><em>optional</em>) – The directory to save the generated figures. If not provided, the current working directory will be used.</p></li>
<li><p><strong>confidence_interval</strong> (<em>float</em><em>, </em><em>optional</em>) – The confidence interval for calculating the filtering threshold. Default is 0.95.</p></li>
<li><p><strong>n_components</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of components in the Gaussian mixture model. Default is 1.</p></li>
<li><p><strong>population_to_keep</strong> (<em>str</em><em>, </em><em>optional</em>) – For multipopulation models this parameter determines which population should be kept. Options are “largest”, “smallest”, “mostcommon”, “leastcommon”. Default is “mostcommon”.
If set to “largest” or “smallest”, the model is chosen which has the largest or smallest mean. If set to “mostcommon” or “leastcommon”, the model is chosen whose population is least or most common.</p></li>
<li><p><strong>filter_lower</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to filter objects that are smaller than the lower threshold. Default is True.</p></li>
<li><p><strong>filter_upper</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to filter objects that are larger than the upper threshold. Default is True.</p></li>
<li><p><strong>*args</strong> – Additional positional arguments.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a SizeFilter object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">filter</span> <span class="o">=</span> <span class="n">SizeFilter</span><span class="p">(</span><span class="n">filter_threshold</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;my_mask&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply the filter to a mask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_mask</span> <span class="o">=</span> <span class="nb">filter</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">input_mask</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the object IDs to be removed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids_to_remove</span> <span class="o">=</span> <span class="nb">filter</span><span class="o">.</span><span class="n">get_ids_to_remove</span><span class="p">(</span><span class="n">input_mask</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Update the mask by removing the identified object IDs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">updated_mask</span> <span class="o">=</span> <span class="nb">filter</span><span class="o">.</span><span class="n">update_mask</span><span class="p">(</span><span class="n">input_mask</span><span class="p">,</span> <span class="n">ids_to_remove</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.SizeFilter.load_mask">
<span class="sig-name descname"><span class="pre">load_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.SizeFilter.load_mask" title="Link to this definition"></a></dt>
<dd><p>Load the mask to be filtered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mask</strong> (<em>numpy.ndarray</em>) – The mask to be filtered.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.SizeFilter.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.SizeFilter.filter" title="Link to this definition"></a></dt>
<dd><p>Filter the input mask based on the filtering threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_mask</strong> (<em>ndarray</em>) – The input mask to be filtered. Expected shape is (X, Y)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>filtered_mask</strong> – The filtered mask after settings the IDs which do not fullfill the filtering criteria to 0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scportrait.processing.filtering.</span></span><span class="sig-name descname"><span class="pre">MatchNucleusCytosolIds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filtering_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erosion_dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds" title="Link to this definition"></a></dt>
<dd><p>Filter class for matching nucleusIDs to their matching cytosol IDs and removing all classes from the given
segmentation masks that do not fullfill the filtering criteria.</p>
<p>Masks only pass filtering if both a nucleus and a cytosol mask are present and have an overlapping area
larger than the specified threshold. If the threshold is not specified, the default value is set to 0.5.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filtering_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold for filtering cytosol IDs based on the proportion of overlapping area with the nucleus. Default is 0.5.</p></li>
<li><p><strong>downsampling_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – The downsampling factor for the masks. Default is None.</p></li>
<li><p><strong>erosion_dilation</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to perform erosion and dilation on the masks during upscaling. Default is True.</p></li>
<li><p><strong>smoothing_kernel_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of the smoothing kernel for upscaling. Default is 7.</p></li>
<li><p><strong>*args</strong> – Additional positional arguments.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.filtering_threshold">
<span class="sig-name descname"><span class="pre">filtering_threshold</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.filtering_threshold" title="Link to this definition"></a></dt>
<dd><p>The threshold for filtering cytosol IDs based on the proportion of overlapping area with the nucleus.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.downsample">
<span class="sig-name descname"><span class="pre">downsample</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.downsample" title="Link to this definition"></a></dt>
<dd><p>Flag indicating whether downsampling is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.downsampling_factor">
<span class="sig-name descname"><span class="pre">downsampling_factor</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.downsampling_factor" title="Link to this definition"></a></dt>
<dd><p>The downsampling factor for the masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.erosion_dilation">
<span class="sig-name descname"><span class="pre">erosion_dilation</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.erosion_dilation" title="Link to this definition"></a></dt>
<dd><p>Flag indicating whether to perform erosion and dilation on the masks during upscaling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.smoothing_kernel_size">
<span class="sig-name descname"><span class="pre">smoothing_kernel_size</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.smoothing_kernel_size" title="Link to this definition"></a></dt>
<dd><p>The size of the smoothing kernel for upscaling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.nucleus_mask">
<span class="sig-name descname"><span class="pre">nucleus_mask</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.nucleus_mask" title="Link to this definition"></a></dt>
<dd><p>The nucleus mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.cytosol_mask">
<span class="sig-name descname"><span class="pre">cytosol_mask</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.cytosol_mask" title="Link to this definition"></a></dt>
<dd><p>The cytosol mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.nuclei_discard_list">
<span class="sig-name descname"><span class="pre">nuclei_discard_list</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.nuclei_discard_list" title="Link to this definition"></a></dt>
<dd><p>A list of nucleus IDs to be discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.cytosol_discard_list">
<span class="sig-name descname"><span class="pre">cytosol_discard_list</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.cytosol_discard_list" title="Link to this definition"></a></dt>
<dd><p>A list of cytosol IDs to be discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.nucleus_lookup_dict">
<span class="sig-name descname"><span class="pre">nucleus_lookup_dict</span></span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.nucleus_lookup_dict" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping nucleus IDs to matched cytosol IDs after filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.load_masks">
<span class="sig-name descname"><span class="pre">load_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nucleus_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cytosol_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.load_masks" title="Link to this definition"></a></dt>
<dd><p>Load the nucleus and cytosol masks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.update_cytosol_mask">
<span class="sig-name descname"><span class="pre">update_cytosol_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cytosol_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.update_cytosol_mask" title="Link to this definition"></a></dt>
<dd><p>Update the cytosol mask based on the matched nucleus-cytosol pairs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.update_masks">
<span class="sig-name descname"><span class="pre">update_masks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.update_masks" title="Link to this definition"></a></dt>
<dd><p>Update the nucleus and cytosol masks after filtering.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.match_nucleus_id">
<span class="sig-name descname"><span class="pre">match_nucleus_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nucleus_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.match_nucleus_id" title="Link to this definition"></a></dt>
<dd><p>Match the given nucleus ID to a cytosol ID based on the overlapping area.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.initialize_lookup_table">
<span class="sig-name descname"><span class="pre">initialize_lookup_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.initialize_lookup_table" title="Link to this definition"></a></dt>
<dd><p>Initialize the lookup table by matching all nucleus IDs to cytosol IDs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.count_cytosol_occurances">
<span class="sig-name descname"><span class="pre">count_cytosol_occurances</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.count_cytosol_occurances" title="Link to this definition"></a></dt>
<dd><p>Count the occurrences of each cytosol ID in the lookup table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.check_for_unassigned_cytosols">
<span class="sig-name descname"><span class="pre">check_for_unassigned_cytosols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.check_for_unassigned_cytosols" title="Link to this definition"></a></dt>
<dd><p>Check for unassigned cytosol IDs in the cytosol mask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.identify_multinucleated_cells">
<span class="sig-name descname"><span class="pre">identify_multinucleated_cells</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.identify_multinucleated_cells" title="Link to this definition"></a></dt>
<dd><p>Identify and discard multinucleated cells from the lookup table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.cleanup_filtering_lists">
<span class="sig-name descname"><span class="pre">cleanup_filtering_lists</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.cleanup_filtering_lists" title="Link to this definition"></a></dt>
<dd><p>Cleanup the discard lists by removing duplicate entries.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.cleanup_lookup_dictionary">
<span class="sig-name descname"><span class="pre">cleanup_lookup_dictionary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.cleanup_lookup_dictionary" title="Link to this definition"></a></dt>
<dd><p>Cleanup the lookup dictionary by removing discarded nucleus-cytosol pairs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.generate_lookup_table">
<span class="sig-name descname"><span class="pre">generate_lookup_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nucleus_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cytosol_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.generate_lookup_table" title="Link to this definition"></a></dt>
<dd><p>Generate the lookup table by performing all necessary steps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nucleus_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cytosol_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.filter" title="Link to this definition"></a></dt>
<dd><p>Filter the nucleus and cytosol masks based on the matching results.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scportrait.processing.filtering.MatchNucleusCytosolIds.get_lookup_table">
<span class="sig-name descname"><span class="pre">get_lookup_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nucleus_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cytosol_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scportrait.processing.filtering.MatchNucleusCytosolIds.get_lookup_table" title="Link to this definition"></a></dt>
<dd><p>Generate the lookup table by performing all necessary steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nucleus_mask</strong> (<em>numpy.ndarray</em>) – The nucleus mask.</p></li>
<li><p><strong>cytosol_mask</strong> (<em>numpy.ndarray</em>) – The cytosol mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lookup table mapping nucleus IDs to matched cytosol IDs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nucleus_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cytosol_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Filter the nucleus and cytosol masks based on the matching results and return the updated masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nucleus_mask</strong> (<em>numpy.ndarray</em>) – The nucleus mask.</p></li>
<li><p><strong>cytosol_mask</strong> (<em>numpy.ndarray</em>) – The cytosol mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the updated nucleus mask and cytosol mask after filtering.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../module.html" class="btn btn-neutral float-left" title="Module Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pipeline.html" class="btn btn-neutral float-right" title="pipeline" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024 Sophia Mädler and Niklas Schmacke.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>